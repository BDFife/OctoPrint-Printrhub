<div class="printrbar">

  <h1 class="printrbar_item titles printrbar_left"> {{printrbar_title}} </h1>

  <!-- DROP DOWN MENU -->
  <div class="printrbar_item printrbar_right titles">
    <div id="printrbar_dropdown">

      <div id="printrbar_caret">
        <span id="username">Please Login</span>
        <i class="fas fa-caret-down"></i>
      </div>

      <div id="printrbar_dropdown-menu">
        <ul>
          <li class="printrbar_menu_item"><a class="printrbar_menu_item_link" href="/plugin/Printrhub/settings?apikey=">Settings</a></li>
          <li class="printrbar_menu_item" id="printrbar_menu_item_serverVer">ip address</li>
          <li class="printrbar_menu_item" id="printrbar_menu_item_apiVer">API Version</li>
        </ul>
      </div>

    </div>
  </div>

</div> <!-- printrbar -->

<script>

  const renderDataInMenuDropdown = async () => {
    var usernameComponent = document.getElementById('username');
    const user = await Printrhub.getUserName();
    if (user !== DEFAULT_RETURN_VALUE) {
      usernameComponent.innerHTML = user;
    }

    var serverVerComponent = document.getElementById('printrbar_menu_item_serverVer');
    const serverVer = await Printrhub.getServerVersion();
    if (serverVer !== DEFAULT_RETURN_VALUE) {
      serverVerComponent.innerHTML = `Server Ver: ${serverVer}`;
    }

    var apiVerComponent = document.getElementById('printrbar_menu_item_apiVer');
    const apiVer = await Printrhub.getApiVersion();
    if (apiVer !== DEFAULT_RETURN_VALUE) {
      apiVerComponent.innerHTML = `API Ver: ${apiVer}`;
    }

  };

  document.onload = renderDataInMenuDropdown();

  /* ********************************************************** Drop down menu */
  var dropdownmenu = document.getElementById('printrbar_dropdown-menu');
  var caret = document.getElementById("printrbar_caret");

  caret.onclick = function() {
    if (dropdownmenu.style.display === "flex") {
      dropdownmenu.style.display = "none";
    } else {
      dropdownmenu.style.display = "flex";
    }
  }

  window.onclick = function(event) {
    //alert(event.target);
    if (event.target == dropdownmenu) {
        dropdownmenu.style.display = "none";
    }
  }

</script>
